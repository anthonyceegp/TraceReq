<% if !active_settings? %>
  <nav id="sidebar" class="mCustomScrollbar">
    <ul id="navigation" class="list-unstyled menu">
      <% if @project.nil? || @project.new_record? %>
        <li class="nav-item <%= active_for(path: projects_path) %>">
          <%= link_to "Projects", projects_path, class: "nav-link" %>
        </li>
      <% else %>
        <li class="nav-item <%= active_for(path: projects_path) %>">
          <%= link_to "Projects", projects_path, class: "nav-link" %>
        </li>
        <li class="nav-item <%= active_project? ? 'active' : '' %>">
          <a data-toggle="collapse" data-parent="#navigation" href="#project" aria-expanded="<%= active_project? ? 'true' : 'false' %>" aria-controls="project" class="nav-link <%= active_project? ? '' : 'collapsed' %>"><%= @project.name %></a>
        </li>
        <ul id="project" class="list-unstyled collapse submenu <%= active_project? ? 'show' : '' %>" role="tabpanel">
          <li class="<%= active_for(path: project_path(@project)) + active_for(path: edit_project_path(@project))%>">
              <%= link_to 'Show', @project, class: "nav-link" %>
          </li>
          <li class="<%= active_for(path: project_demands_path(@project)) + active_for(path: new_project_demand_path(@project)) %>">
            <%= link_to 'Demands', project_demands_path(@project), class: "nav-link" %>
          </li>
          <li class="<%= active_for(path: project_artifacts_path(@project)) %>">
            <%= link_to 'Artifacts', project_artifacts_path(@project), class: "nav-link" %>
          </li>
          <li class="<%= active_for(path: project_relationships_path(@project)) %>">
            <%= link_to 'Relationships', project_relationships_path(@project), class: "nav-link" %>
          </li>
          <li class="<%= active_for(path: new_project_relationship_path(@project)) %>">
            <%= link_to 'New Relationship', new_project_relationship_path(@project), class: "nav-link"%>
            </li>
          <li class="">
            <%= link_to 'Settings', project_artifact_types_path(@project), class: "nav-link" %>
          </li>
        </ul>
        <% if active_demand? %>
          <li class="nav-item item <%= active_demand? ? 'active' : '' %>">
            <a data-toggle="collapse" data-parent="#navigation" href="#demand" aria-expanded="<%= active_demand? ? 'true' : 'false' %>" aria-controls="demand" class="nav-link <%= active_demand? ? '' : 'collapsed' %>"><%= @demand.name %></a>
          </li>
          <ul id="demand" class="list-unstyled collapse submenu <%= active_demand? ? 'show' : '' %>" role="tabpanel">
            <li class="<%= active_for(path: project_demand_path(@project, @demand)) + active_for(path: edit_project_demand_path(@project, @demand)) %>">
              <%= link_to 'Show', project_demand_path(@project, @demand), class: "nav-link" %>
            </li>
            <li class="<%= active_for(path: project_demand_artifacts_path(@project, @demand)) + active_for(path: new_project_demand_artifact_path(@project, @demand)) + active_for(controller: 'artifacts', action: 'show') + active_for(controller: 'artifacts', action: 'edit') + active_for(controller: 'artifacts', action: 'versions') %>">
              <%= link_to 'Artifacts', project_demand_artifacts_path(@project, @demand), class: "nav-link" %>
            </li>
            <li class="<%= active_for(path: import_artifacts_path(@project, @demand)) %>">
              <%= link_to 'Import Artifacts', import_artifacts_path(@project, @demand), class: "nav-link" %>
            </li>
            <li class="<%= active_for(path: project_demand_relationships_path(@project, @demand)) %>">
              <%= link_to 'Relationships', project_demand_relationships_path(@project, @demand), class: "nav-link" %>
            </li>
            <li class="<%= active_for(path: new_project_demand_relationship_path(@project, @demand)) %>">
              <%= link_to 'New Relationship', new_project_demand_relationship_path(@project, @demand), class: "nav-link"%>
            </li>
          </ul>
        <% end %>
      <% end %>
    </ul>
  </nav>
<% else %>
  <%= render "layouts/sidebar_settings" %>
<% end %>